<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LLM Madness - Inspector</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="brand">
        <h1>LLM Madness</h1>
        <p class="subtitle">Local LLM experiments, clear artifacts.</p>
      </div>
      <div class="theme-switch">
        <span>Theme</span>
        <button id="themeToggle" class="theme-toggle" type="button">Dark mode</button>
      </div>
      <nav class="side-nav">
        <button class="nav-btn active" data-section="tokenizer-configs">Tokenizer Configs</button>
        <button class="nav-btn" data-section="tokenizer-vocabs">Tokenizer Vocabularies</button>
        <button class="nav-btn" data-section="datasets">Datasets</button>
        <button class="nav-btn" data-section="training-configs">Training Configs</button>
        <button class="nav-btn" data-section="runs">Training Runs</button>
        <button class="nav-btn" data-section="inspector">Inspect</button>
        <button class="nav-btn" data-section="chat">Chat</button>
      </nav>
    </aside>
    <main>
    <section class="page-section active" data-section="tokenizer-configs">
      <div class="configs-layout">
        <div class="panel">
          <div class="panel-head">
            <div>
              <h2>Tokenizer Configs</h2>
              <p class="meta">Save every change as a new version.</p>
            </div>
          </div>
          <div class="controls">
            <input id="tokenizerConfigSearch" type="text" placeholder="Search configs..." />
            <select id="tokenizerConfigSort" class="tab-select">
              <option value="recent">Sort: recent</option>
              <option value="name">Sort: name</option>
              <option value="version">Sort: version</option>
            </select>
          </div>
          <div id="tokenizerConfigList" class="artifact-list config-list"></div>
        </div>
        <div class="panel config-editor-panel">
          <div class="panel-head">
            <div>
              <h2>Config Details</h2>
              <div class="meta" id="tokenizerConfigMeta"></div>
            </div>
            <div class="controls">
              <button id="tokenizerConfigNew" class="primary">New</button>
              <button id="tokenizerConfigDuplicate">Duplicate</button>
              <button id="tokenizerConfigSave" class="primary">Save New Version</button>
            </div>
          </div>
          <div class="preview-tabs">
            <select id="tokenizerConfigTabSelect" class="tab-select">
              <option value="editor">Editor</option>
              <option value="summary">Summary</option>
              <option value="defaults">Defaults</option>
            </select>
          </div>
          <div class="preview-body">
            <div class="preview-panel" data-preview="editor">
              <textarea id="tokenizerConfigEditor" spellcheck="false"></textarea>
            </div>
            <div class="preview-panel is-hidden" data-preview="summary">
              <div id="tokenizerConfigSummary" class="summary-grid"></div>
            </div>
            <div class="preview-panel is-hidden" data-preview="defaults">
              <div id="tokenizerConfigDefaults" class="summary-grid"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="page-section" data-section="tokenizer-vocabs">
      <div class="vocabs-layout">
        <div class="vocab-stack">
          <div class="panel">
            <div class="panel-head">
              <div>
                <h2>Create New Vocab</h2>
                <p class="meta">Generated artifacts tied to config + dataset.</p>
              </div>
              <button id="tokenizerVocabRefresh" class="primary">Refresh</button>
            </div>
            <div class="controls">
              <select id="tokenizerVocabConfigSelect"></select>
              <button id="tokenizerVocabRefreshConfigs">Refresh Configs</button>
            </div>
            <div class="controls">
              <select id="tokenizerVocabDatasetSelect"></select>
              <button id="tokenizerVocabRefreshDatasets">Refresh Datasets</button>
            </div>
            <div class="controls">
              <input id="tokenizerVocabName" type="text" placeholder="Optional vocab name" />
            </div>
            <div class="controls">
              <button id="tokenizerVocabCreate" class="primary">Generate Vocab</button>
            </div>
            <div class="meta" id="tokenizerVocabProgressMeta"></div>
            <div id="tokenizerVocabProgressLine" class="progress-line"></div>
            <div class="meta" id="tokenizerVocabMeta"></div>
          </div>
          <div class="panel">
            <div class="panel-head">
              <h2>Vocab Runs</h2>
              <button id="tokenizerVocabRefreshList" class="primary">Refresh</button>
            </div>
            <div id="tokenizerVocabList" class="artifact-list vocab-list"></div>
          </div>
        </div>
        <div class="panel vocab-preview">
          <div class="panel-head">
            <div>
              <h2>Vocab Details</h2>
              <div class="meta" id="tokenizerVocabDetailsMeta"></div>
            </div>
            <div class="preview-tabs">
              <select id="tokenizerVocabTabSelect" class="tab-select">
                <option value="report">Report</option>
                <option value="config">Config</option>
                <option value="tokens">Tokens</option>
              </select>
            </div>
          </div>
          <div class="preview-body">
            <div class="preview-panel" data-preview="report">
              <textarea id="tokenizerVocabDetails" readonly spellcheck="false"></textarea>
            </div>
            <div class="preview-panel is-hidden" data-preview="config">
              <div class="meta" id="tokenizerVocabConfigMeta"></div>
              <textarea id="tokenizerVocabConfig" readonly spellcheck="false"></textarea>
            </div>
            <div class="preview-panel is-hidden" data-preview="tokens">
              <div class="controls">
                <input id="tokenizerVocabTokenSearch" type="text" placeholder="Filter tokens..." />
                <input id="tokenizerVocabTokenLimit" type="number" min="10" max="2000" value="200" />
                <button id="tokenizerVocabTokenRefresh" class="primary">Load</button>
              </div>
              <div class="meta" id="tokenizerVocabTokenMeta"></div>
              <div id="tokenizerVocabTokens" class="token-listing"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="page-section" data-section="training-configs">
      <div class="configs-layout">
        <div class="panel">
          <div class="panel-head">
            <div>
              <h2>Training Configs</h2>
              <p class="meta">Keep every change as a new version.</p>
            </div>
          </div>
          <div class="controls">
            <input id="trainingConfigSearch" type="text" placeholder="Search configs..." />
            <select id="trainingConfigSort" class="tab-select">
              <option value="recent">Sort: recent</option>
              <option value="name">Sort: name</option>
              <option value="version">Sort: version</option>
            </select>
          </div>
          <div id="trainingConfigList" class="artifact-list config-list"></div>
        </div>
        <div class="panel config-editor-panel">
          <div class="panel-head">
            <div>
              <h2>Config Details</h2>
              <div class="meta" id="trainingConfigMeta"></div>
            </div>
            <div class="controls">
              <button id="trainingConfigNew" class="primary">New</button>
              <button id="trainingConfigDuplicate">Duplicate</button>
              <button id="trainingConfigSave" class="primary">Save New Version</button>
            </div>
          </div>
          <div class="preview-tabs">
            <select id="trainingConfigTabSelect" class="tab-select">
              <option value="editor">Editor</option>
              <option value="summary">Summary</option>
              <option value="hyperparams">Hyperparams</option>
            </select>
          </div>
          <div class="preview-body">
            <div class="preview-panel" data-preview="editor">
              <textarea id="trainingConfigEditor" spellcheck="false"></textarea>
            </div>
            <div class="preview-panel is-hidden" data-preview="summary">
              <div id="trainingConfigSummary" class="summary-grid"></div>
            </div>
            <div class="preview-panel is-hidden" data-preview="hyperparams">
              <div id="trainingConfigHyperparams" class="summary-grid"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="page-section" data-section="runs">
      <div class="runs-layout">
        <div class="runs-stack">
          <div class="panel">
            <h2>Create Run</h2>
            <div class="controls">
              <select id="datasetSelect"></select>
              <button id="refreshDatasets" class="primary">Refresh Datasets</button>
            </div>
            <div class="controls">
              <select id="runTokenizerVocabSelect"></select>
              <button id="refreshTokenizerVocabs">Refresh Tokenizer Vocabs</button>
            </div>
            <div class="controls">
              <select id="trainingConfigSelect"></select>
              <button id="refreshTrainingConfigs">Refresh Training Configs</button>
            </div>
            <div class="controls">
              <input id="runName" type="text" placeholder="Optional run name (e.g. baseline-001)" />
            </div>
            <details class="advanced-panel">
              <summary>Advanced options</summary>
              <div class="controls">
                <select id="runInitCheckpointSelect"></select>
                <button id="refreshInitCheckpoints">Refresh Checkpoints</button>
              </div>
              <div class="meta" id="runInitCheckpointMeta"></div>
              <div class="controls">
                <select id="runInitModeSelect">
                  <option value="fresh">Start fresh (no checkpoint)</option>
                  <option value="fork">Warm start (fork)</option>
                  <option value="resume">Resume (optimizer + RNG)</option>
                </select>
              </div>
              <div class="meta">Overrides (leave blank to use config)</div>
              <div class="controls">
                <label>Learning rate <input id="runOverrideLearningRate" type="number" step="any" placeholder="e.g. 0.0003" /></label>
                <label>Max iters <input id="runOverrideMaxIters" type="number" step="1" placeholder="e.g. 3000" /></label>
              </div>
              <div class="controls">
                <label>Batch size <input id="runOverrideBatchSize" type="number" step="1" placeholder="e.g. 32" /></label>
                <label>Eval interval <input id="runOverrideEvalInterval" type="number" step="1" placeholder="e.g. 200" /></label>
              </div>
              <div class="controls">
                <label>Seed <input id="runOverrideSeed" type="number" step="1" placeholder="e.g. 1337" /></label>
                <label>Device
                  <select id="runOverrideDevice">
                    <option value="">auto/cpu/cuda/mps</option>
                    <option value="auto">auto</option>
                    <option value="cpu">cpu</option>
                    <option value="cuda">cuda</option>
                    <option value="mps">mps</option>
                  </select>
                </label>
              </div>
            </details>
            <div class="controls">
              <button class="primary" id="runCreate">Create Run</button>
              <span class="meta" id="runSetupMeta"></span>
            </div>
          </div>
          <div class="panel">
            <div class="panel-head">
              <div>
                <h2>Runs</h2>
                <p class="meta" id="runsMeta"></p>
              </div>
              <button id="refreshRuns" class="primary">Refresh</button>
            </div>
            <div class="controls">
              <input id="runsSearch" placeholder="Search runs" />
              <select id="runsFilterStatus"></select>
            </div>
            <div class="runs-columns">
              <details class="runs-section" open>
                <summary>Active</summary>
                <div id="runsActiveList" class="runs-list"></div>
              </details>
              <details class="runs-section">
                <summary>History</summary>
                <div id="runsHistoryList" class="runs-list"></div>
              </details>
            </div>
          </div>
        </div>
        <div class="panel run-preview">
          <div class="panel-head">
            <div>
              <h2>Run Inspector</h2>
              <div class="meta" id="runDetailMeta">Select a run to inspect.</div>
            </div>
            <select id="runInspectorTabSelect" class="tab-select">
              <option value="overview">Overview</option>
              <option value="details">Details</option>
              <option value="tokenizer">Tokenizer</option>
            </select>
          </div>
          <div class="meta" id="runLoadStatus"></div>
          <div class="preview-body">
            <div class="preview-panel" data-preview="overview">
              <div class="run-highlights">
                <div>
                  <span>Dataset</span>
                  <strong id="runDatasetName">-</strong>
                </div>
                <div>
                  <span>Tokenizer vocab</span>
                  <strong id="runTokenizerName">-</strong>
                </div>
                <div>
                  <span>Training config</span>
                  <strong id="runTrainingConfigName">-</strong>
                </div>
              </div>
              <div class="run-loss">
                <div class="meta">Loss (train/val)</div>
                <div id="runLossChart" class="chart run-loss-chart"></div>
                <div class="meta" id="runLossMeta"></div>
              </div>
              <div class="controls">
                <select id="runLogsSelect" class="tab-select">
                  <option value="logs">logs.jsonl</option>
                  <option value="process">process.log</option>
                </select>
              </div>
              <pre id="runLogs" class="run-detail"></pre>
            </div>
            <div class="preview-panel is-hidden" data-preview="details">
              <div class="summary-grid run-details-card" id="runDetails"></div>
            </div>
            <div class="preview-panel is-hidden" data-preview="tokenizer">
              <div id="runTokenizerReport" class="run-tokenizer-report">
                <div class="controls">
                  <button id="runTokenizerReportRefresh" class="primary">Refresh</button>
                  <span class="meta" id="runTokenizerReportMeta"></span>
                </div>
                <table id="runTokenizerReportTable">
                  <thead>
                    <tr><th>Token</th><th>ID</th><th>Count</th></tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="page-section" data-section="datasets">
      <div class="datasets-layout">
        <div class="dataset-stack">
          <div class="panel">
            <h2>Dataset Browser (data/)</h2>
            <div class="controls">
              <span id="datasetPath" class="meta">data/</span>
              <button id="datasetRefresh" class="primary">Refresh</button>
            </div>
            <div id="datasetEntries" class="file-list"></div>
            <h3>Selections</h3>
            <div class="meta" id="datasetMeta"></div>
            <textarea id="datasetSelections" readonly spellcheck="false"></textarea>
            <h3>Create Dataset Manifest</h3>
            <div class="controls">
              <input id="datasetName" placeholder="Optional name (e.g. wiki-small)" />
              <label class="meta">
                <input id="datasetEnableHashes" type="checkbox" />
                Enable content hashes
              </label>
              <button id="datasetCreate" class="primary">Create</button>
            </div>
            <div class="meta" id="datasetCreateMeta"></div>
          </div>
          <div class="panel">
            <div class="panel-head">
              <h2>Existing Manifests</h2>
              <button id="datasetRefreshManifests" class="primary">Refresh</button>
            </div>
            <div id="datasetManifestList" class="artifact-list"></div>
          </div>
        </div>
        <div class="panel dataset-preview">
          <div class="panel-head">
            <div>
              <h2>Manifest Preview</h2>
              <div class="meta" id="datasetManifestMeta"></div>
            </div>
            <div class="preview-tabs">
              <select id="datasetPreviewSelect" class="tab-select">
                <option value="manifest">Manifest</option>
                <option value="files">Files</option>
              </select>
            </div>
          </div>
          <div class="preview-body">
            <div class="preview-panel" data-preview="manifest">
              <textarea id="datasetManifestPreview" readonly spellcheck="false"></textarea>
            </div>
            <div class="preview-panel is-hidden" data-preview="files">
              <div id="datasetManifestFiles" class="manifest-files"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="page-section" data-section="inspector">
      <div class="inspector-layout">
        <div class="inspector-left">
          <div class="panel">
            <h2>Model Session</h2>
            <div class="controls">
              <span class="meta" id="runMeta">Loading run...</span>
            </div>
            <div class="controls">
              <select id="sessionRunSelect"></select>
              <button id="loadSessionRun" class="primary">Load Run</button>
              <span class="meta" id="sessionRunMeta"></span>
            </div>
            <div class="controls">
              <select id="checkpointSelect"></select>
              <button id="loadCheckpoint" class="primary">Load</button>
              <span class="meta" id="checkpointMeta"></span>
            </div>
          </div>
          <div class="panel">
            <h2>Prompt</h2>
            <div class="controls">
              <button id="tokenizeBtn" class="primary">Tokenize</button>
              <button id="decodeBtn">Decode</button>
            </div>
            <div class="controls">
              <label>Steps <input id="inspectSampleSteps" type="number" value="32" min="1" max="256" /></label>
              <label>Temp <input id="inspectTemperature" type="number" value="1.0" min="0" max="2" step="0.05" /></label>
              <label>Top-p <input id="inspectTopP" type="number" value="0.9" min="0" max="1" step="0.05" /></label>
              <label>Top-k <input id="inspectTopKSample" type="number" value="0" min="0" max="200" /></label>
              <button id="inspectGenerateBtn">Generate</button>
            </div>
            <textarea id="promptInput" placeholder="Type a prompt..." spellcheck="false"></textarea>
            <div class="meta" id="promptMeta"></div>
            <div class="meta" id="promptRolloutMeta"></div>
          </div>
        </div>
        <div class="inspector-right">
          <div class="panel inspector-preview">
            <div class="panel-head">
              <div>
                <h2>Inspector</h2>
                <div class="meta active-token-pill" id="inspectorActiveToken">Active token: -</div>
              </div>
            <select id="inspectorTabSelect" class="tab-select">
              <option value="tokens">Tokens</option>
              <option value="next">Top-k</option>
              <option value="layers">Layers</option>
            </select>
          </div>
            <div class="preview-body">
              <div class="preview-panel" data-preview="tokens">
                <div id="tokenList" class="token-list token-scroll"></div>
              </div>
              <div class="preview-panel is-hidden" data-preview="next">
                <div class="controls">
                  <label>Top-k <input id="topK" type="number" value="8" min="1" max="50" /></label>
                  <button id="nextBtn" class="primary">Probe</button>
                  <span class="meta">Click a token to append it to the prompt.</span>
                </div>
                <div id="nextMeta" class="meta"></div>
                <table id="nextTable">
                  <thead>
                    <tr><th>Rank</th><th>Token</th><th>ID</th><th>Prob</th></tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="preview-panel is-hidden" data-preview="layers">
                <div class="controls">
                  <label>Top-k <input id="inspectTopK" type="number" value="8" min="1" max="50" /></label>
                  <button id="inspectBtn" class="primary">Inspect</button>
                </div>
                <div id="inspectMeta" class="meta"></div>
                <div id="layerTopkWrap">
                  <h3>Layer Top-k</h3>
                  <table id="layerTopkTable">
                    <thead>
                      <tr><th>Layer</th><th>Top-k tokens</th></tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="page-section" data-section="chat">
      <div class="chat-layout">
        <div class="chat-left">
          <div class="panel">
            <h2>Model Session</h2>
            <div class="controls">
              <span class="meta" id="chatRunMeta">Loading run...</span>
            </div>
            <div class="controls">
              <select id="chatSessionRunSelect"></select>
              <button id="chatLoadSessionRun" class="primary">Load Run</button>
              <span class="meta" id="chatSessionRunMeta"></span>
            </div>
            <div class="controls">
              <select id="chatCheckpointSelect"></select>
              <button id="chatLoadCheckpoint" class="primary">Load</button>
              <span class="meta" id="chatCheckpointMeta"></span>
            </div>
          </div>
          <div class="panel">
            <h2>Sampling Controls</h2>
            <div class="controls">
              <label>Max new tokens <input id="chatMaxTokens" type="number" value="128" min="1" max="512" /></label>
              <label>Temp <input id="chatTemperature" type="number" value="1.0" min="0" max="2" step="0.05" /></label>
              <label>Top-p <input id="chatTopP" type="number" value="0.9" min="0" max="1" step="0.05" /></label>
              <label>Top-k <input id="chatTopK" type="number" value="0" min="0" max="200" /></label>
            </div>
            <div class="meta">Adjust sampling to shape the assistant response.</div>
          </div>
        </div>
        <div class="chat-right">
          <div class="panel chat-preview">
            <div class="panel-head">
              <div>
                <h2>Chat</h2>
                <div class="meta" id="chatTranscriptMeta">Special tokens are hidden.</div>
              </div>
              <div class="controls">
                <label class="meta toggle"><input id="chatDebugToggle" type="checkbox" /> Debug</label>
              </div>
            </div>
            <div class="chat-body">
              <div id="chatMessages" class="chat-thread"></div>
              <div class="chat-raw-wrap is-hidden">
                <textarea id="chatTranscript" class="chat-raw" readonly spellcheck="false"></textarea>
              </div>
              <div class="chat-composer">
                <textarea id="chatInput" placeholder="Send a message..." spellcheck="false"></textarea>
                <div class="controls">
                  <button id="chatSend" class="primary">Send</button>
                  <button id="chatClear">Clear</button>
                  <span class="meta" id="chatStatus"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    </main>
  </div>

  <script type="module" src="/static/app.js"></script>
</body>
</html>
